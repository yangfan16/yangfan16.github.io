<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/uploads/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/uploads/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/uploads/favicon-16x16.png"><link rel="mask-icon" href="/uploads/safari-pinned-tab.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"blog.yangfan16.cn",root:"/",scheme:"Mist",version:"7.7.2",exturl:!1,sidebar:{position:"right",display:"hide",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!0,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!0,lazyload:!0,pangu:!0,comments:{style:"buttons",active:"gitalk",storage:!0,lazyload:!1,nav:null,activeClass:"gitalk"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!1,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!0,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="之前一直在使用Travis-CI部署Hexo博客,博客的源文件一直都在私有仓库中，只能只用https:&#x2F;&#x2F;travis-ci.com&#x2F;, 眼看自己的100次机会很快就要用完了，Github 发布Github Actions了， 就简单折腾了一些时间，现在也使用了一段时间了 分享下我的使用过程  我个人比较坚持将代码尽可能的分离，参考我的上一篇博客使用Git Submdule 分离Hexo主题。"><meta property="og:type" content="article"><meta property="og:title" content="使用GitHub Actions 自动构建部署Hexo博客"><meta property="og:url" content="https://blog.yangfan16.cn/hexo/use-actions-github/index.html"><meta property="og:site_name" content="码中月录"><meta property="og:description" content="之前一直在使用Travis-CI部署Hexo博客,博客的源文件一直都在私有仓库中，只能只用https:&#x2F;&#x2F;travis-ci.com&#x2F;, 眼看自己的100次机会很快就要用完了，Github 发布Github Actions了， 就简单折腾了一些时间，现在也使用了一段时间了 分享下我的使用过程  我个人比较坚持将代码尽可能的分离，参考我的上一篇博客使用Git Submdule 分离Hexo主题。"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2020-03-31T04:10:45.000Z"><meta property="article:modified_time" content="2020-04-01T06:07:32.467Z"><meta property="article:author" content="青梅煮马"><meta property="article:tag" content="hexo"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://blog.yangfan16.cn/hexo/use-actions-github/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>使用GitHub Actions 自动构建部署Hexo博客 | 码中月录</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">码中月录</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">和世界交手的这许多年，你是否光彩依旧，兴致盎然</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li></ul></nav></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a> <a href="https://github.com/yangfan16" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.yangfan16.cn/hexo/use-actions-github/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/uploads/avatar.png"><meta itemprop="name" content="青梅煮马"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="码中月录"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> 使用GitHub Actions 自动构建部署Hexo博客</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-03-31 12:10:45" itemprop="dateCreated datePublished" datetime="2020-03-31T12:10:45+08:00">2020-03-31</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-04-01 14:07:32" itemprop="dateModified" datetime="2020-04-01T14:07:32+08:00">2020-04-01</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/hexo/" itemprop="url" rel="index"><span itemprop="name">hexo</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>4.7k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span>4 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>之前一直在使用Travis-CI部署Hexo博客,博客的源文件一直都在私有仓库中，只能只用<a href="https://travis-ci.com/" target="_blank" rel="noopener">https://travis-ci.com/</a>, 眼看自己的100次机会很快就要用完了，Github 发布Github Actions了， 就简单折腾了一些时间，现在也使用了一段时间了 分享下我的使用过程</p></blockquote><p>我个人比较坚持将代码尽可能的分离，<a href="https://blog.yangfan16.cn/hexo/use-sub-theme/">参考我的上一篇博客使用Git Submdule 分离Hexo主题</a>。 另外，<br>Hexo和NexT配置文件中包含一些不太适合公开的信息，比如leancloud的AK SK , 还有一些ApplicationID等等。这两个部分在我使用Github-actions的过程中造成了不少使用上的麻烦，解决的过程我尽可能详细的在文章中记录下来，方便下次查阅。</p><a id="more"></a><blockquote><p>Ps: <a href="https://xirikm.net/" target="_blank" rel="noopener">感谢xirikm博主的邮件答复和耐心解惑</a></p></blockquote><h2 id="关于GitHub-Actions"><a href="#关于GitHub-Actions" class="headerlink" title="关于GitHub Actions"></a>关于GitHub Actions</h2><p>GitHub Actions 是Github推出的又一款持续继承服务，功能类似于Travis-CI,但是直接与Github集成，可以在github页面直接查看构建和部署的过程，方便不少。<br>还有就是我的博客源文件仓库是私有仓库，只能免费使用Travis-ci.com构建一百次。 要想使用travis-ci.org还必须得公有仓库，Actions倒是没有这方面的条件。<br>此外 <a href="https://github.com/marketplace?type=actions" target="_blank" rel="noopener">Github还推出了一个Actions MarketPlace</a>, 里面包含了不少他人提交的Actions; <a href="https://github.com/sdras/awesome-actions" target="_blank" rel="noopener">还有人搞了一个<br>awesome</a> 这就免去了重复写actions的过程。</p><p>官方文档给出了非常详解的解释和用例，<a href="https://help.github.com/en/actions" target="_blank" rel="noopener">具体请移步这里</a> , 中文文档翻译的稀碎，我英文不太好，还是有选择的看了些英文的文档。</p><h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><ul><li><em>workflow</em> （工作流程）：持续集成一次运行的过程，就是一个 workflow。</li><li><em>job</em> （任务）：一个 workflow 由一个或多个 jobs 构成，含义是一次持续集成的运行，可以完成多个任务。</li><li><em>step</em>（步骤）：每个 job 由多个 step 构成，一步步完成。</li><li><em>action</em> （动作）：每个 step 可以依次执行一个或多个命令（action）。</li></ul><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>我的博客是有三个仓库 一个私有的博客主题文件仓库（NexT主题，fork后自己拉分支更新自己的配置）， 一个私有的博客源文件仓库， 使用git submodule 引用自己的私有主题仓库。 一个公有的github Page 仓库。</p><p>需要获取一个GitHub Personal Access Token 用来推送构建好的文件到公有的 GitHub Pages仓库, PAT(Personal Access Token)的创建过程：点击 GitHub 用户设置页面 最下方的 Developer setting ，然后选择 Personal access tokens 来生成一个 token，由于我们只需要能够对普通仓库 push 就行了，所以把 repo 部分勾上即可。</p><blockquote><p>Ps: 生成的 token 只会显示一次，一定要及时保存下来，否则就只能删除重新创建了</p></blockquote><p>创建两个安全环境变量: 点开博客源文件仓库上方的 Settings，点到左侧的 Secrets 项，添加两个环境变量 GH_REF 、GH_TOKEN，值分别填写自己的 GitHub Pages 仓库地址（不包含 https:// ）和刚刚申请到的PAT</p><h2 id="具体步骤"><a href="#具体步骤" class="headerlink" title="具体步骤"></a>具体步骤</h2><p>准备工作做好之后就可以写GitHub Actions 配置文件了。</p><h3 id="触发条件和运行环境"><a href="#触发条件和运行环境" class="headerlink" title="触发条件和运行环境"></a>触发条件和运行环境</h3><p>设置在master分支上push操作的时候触发构建部署动作 使用最新的 Ubuntu 系统作为编译部署的环境，同时设置一个全局环境变量将时区修改为 Asia/Shanghai，具体的配置部分为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">name: MyBlog CI&#x2F;CD</span><br><span class="line">  </span><br><span class="line">on:</span><br><span class="line">  push:</span><br><span class="line">    branches: </span><br><span class="line">      - master</span><br><span class="line">env:</span><br><span class="line">  TZ: Asia&#x2F;Shanghai</span><br><span class="line">  </span><br><span class="line">jobs:</span><br><span class="line">  blog-cicd:</span><br><span class="line">    name: Hexo blog build &amp; deploy</span><br><span class="line">    runs-on: ubuntu-latest</span><br><span class="line">    </span><br><span class="line">steps:</span><br><span class="line">............</span><br></pre></td></tr></table></figure><h3 id="检出代码和submodule"><a href="#检出代码和submodule" class="headerlink" title="检出代码和submodule"></a>检出代码和submodule</h3><p>由于我的主题文件是私有仓库，需要在检出的时候使用PAT。另外，.gitmodules文件中的url要是https格式而非ssh格式<a href="https://github.com/actions/checkout/issues/116" target="_blank" rel="noopener">参考这个issue</a>,<a href="https://github.community/t5/GitHub-Actions/How-to-checkout-a-private-submodule-from-a-github-action/td-p/33803" target="_blank" rel="noopener">还有这个社区文档</a></p><p>具体配置部分为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">steps:</span><br><span class="line">- name: Checkout codes</span><br><span class="line">  uses: actions&#x2F;checkout@v2</span><br><span class="line"></span><br><span class="line">- name: Checkout Private submodules</span><br><span class="line">  uses: actions&#x2F;checkout@v2</span><br><span class="line">  with:</span><br><span class="line">    repository: yangfan16&#x2F;hexo-theme-next</span><br><span class="line">    token: $&#123;&#123; secrets.GH_TOKEN &#125;&#125;</span><br><span class="line">    path: themes&#x2F;next</span><br><span class="line"></span><br><span class="line">  ............</span><br></pre></td></tr></table></figure><h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><p>官方不建议直接缓存 node_modules 目录，所以这里设置的是 npm 的下载缓存目录 ~/.npm，这样后面仍需要使用 npm install 来安装依赖。使用的是 package-lock.json 文件的 hash 值来标识缓存是否可以命中，避免每次都要重新下载，从而加快构建速度。 除此之外使用gulp压缩混淆前端代码。</p><p>具体的配置部分:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- name: Setup node</span><br><span class="line">uses: actions&#x2F;setup-node@v1</span><br><span class="line">with:</span><br><span class="line">  node-version: &#39;13.x&#39;</span><br><span class="line"></span><br><span class="line">- name: Cache node modules</span><br><span class="line">uses: actions&#x2F;cache@v1</span><br><span class="line">with:</span><br><span class="line">    path: ~&#x2F;.npm</span><br><span class="line">    key: $&#123;&#123; runner.os &#125;&#125;-node-$&#123;&#123; hashFiles(&#39;**&#x2F;package-lock.json&#39;) &#125;&#125;</span><br><span class="line"></span><br><span class="line">- name: Install dependencies</span><br><span class="line">run: |</span><br><span class="line">  npm install hexo-cli gulp -g</span><br><span class="line">  npm install</span><br><span class="line"></span><br><span class="line">- name: Generate files</span><br><span class="line">run: hexo clean &amp;&amp; hexo generate</span><br><span class="line"></span><br><span class="line">- name: Execute gulp task</span><br><span class="line">run:  gulp</span><br><span class="line">............</span><br></pre></td></tr></table></figure><h3 id="部署博客"><a href="#部署博客" class="headerlink" title="部署博客"></a>部署博客</h3><p>网上的解决方案大多是生成SSH and GPG keys 然后在配置文件中加载私钥。 步骤繁杂，配置文件中一堆手写ssh密钥，不安全也不优雅，需要先安装Hexo的环境，</p><p>我这边直接clone代码，然后push到我的Github Pages私有仓库文件里，具体的配置部分为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- name: Deploy blog</span><br><span class="line">run: |</span><br><span class="line">  git clone &quot;https:&#x2F;&#x2F;$&#123;&#123; secrets.GH_REF &#125;&#125;&quot; deploy_git</span><br><span class="line">  mv .&#x2F;deploy_git&#x2F;.git .&#x2F;public&#x2F;</span><br><span class="line">  cd .&#x2F;public</span><br><span class="line">  git config user.name &quot;yangfan&quot;</span><br><span class="line">  git config user.email &quot;yangfan9915@gmail.com&quot;</span><br><span class="line">  git add .</span><br><span class="line">  git commit -m &quot;GitHub Actions Auto Builder at $(date +&#39;%Y-%m-%d %H:%M:%S&#39;)&quot;</span><br><span class="line">  git push --force --quiet &quot;https:&#x2F;&#x2F;$&#123;&#123; secrets.GH_TOKEN &#125;&#125;@$&#123;&#123; secrets.GH_REF &#125;&#125;&quot; master:master</span><br></pre></td></tr></table></figure><h3 id="完整配置文件"><a href="#完整配置文件" class="headerlink" title="完整配置文件"></a>完整配置文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">name: MyBlog CI&#x2F;CD</span><br><span class="line"></span><br><span class="line">on:</span><br><span class="line">  push:</span><br><span class="line">    branches: </span><br><span class="line">      - master</span><br><span class="line"></span><br><span class="line">env:</span><br><span class="line">  TZ: Asia&#x2F;Shanghai</span><br><span class="line"></span><br><span class="line">jobs:</span><br><span class="line">  blog-cicd:</span><br><span class="line">    name: Hexo blog build &amp; deploy</span><br><span class="line">    runs-on: ubuntu-latest</span><br><span class="line"></span><br><span class="line">    steps:</span><br><span class="line">    - name: Checkout codes</span><br><span class="line">      uses: actions&#x2F;checkout@v2</span><br><span class="line"></span><br><span class="line">    - name: Checkout Private submodules</span><br><span class="line">      uses: actions&#x2F;checkout@v2</span><br><span class="line">      with:</span><br><span class="line">        repository: yangfan16&#x2F;hexo-theme-next</span><br><span class="line">        token: $&#123;&#123; secrets.GH_TOKEN &#125;&#125;</span><br><span class="line">        path: themes&#x2F;next</span><br><span class="line">      </span><br><span class="line">    - name: Setup node</span><br><span class="line">      uses: actions&#x2F;setup-node@v1</span><br><span class="line">      with:</span><br><span class="line">        node-version: &#39;13.x&#39;</span><br><span class="line"></span><br><span class="line">    - name: Cache node modules</span><br><span class="line">      uses: actions&#x2F;cache@v1</span><br><span class="line">      with:</span><br><span class="line">        path: ~&#x2F;.npm</span><br><span class="line">        key: $&#123;&#123; runner.os &#125;&#125;-node-$&#123;&#123; hashFiles(&#39;**&#x2F;package-lock.json&#39;) &#125;&#125;</span><br><span class="line"></span><br><span class="line">    - name: Install dependencies</span><br><span class="line">      run: |</span><br><span class="line">        npm install hexo-cli gulp -g</span><br><span class="line">        npm install</span><br><span class="line"></span><br><span class="line">    - name: Generate files</span><br><span class="line">      run: hexo clean &amp;&amp; hexo generate</span><br><span class="line"></span><br><span class="line">    - name: Execute gulp task</span><br><span class="line">      run:  gulp</span><br><span class="line"></span><br><span class="line">    - name: Deploy blog</span><br><span class="line">      run: |</span><br><span class="line">        git clone &quot;https:&#x2F;&#x2F;$&#123;&#123; secrets.GH_REF &#125;&#125;&quot; deploy_git</span><br><span class="line">        mv .&#x2F;deploy_git&#x2F;.git .&#x2F;public&#x2F;</span><br><span class="line">        cd .&#x2F;public</span><br><span class="line">        git config user.name &quot;yangfan&quot;</span><br><span class="line">        git config user.email &quot;yangfan9915@gmail.com&quot;</span><br><span class="line">        git add .</span><br><span class="line">        git commit -m &quot;GitHub Actions Auto Builder at $(date +&#39;%Y-%m-%d %H:%M:%S&#39;)&quot;</span><br><span class="line">        git push --force --quiet &quot;https:&#x2F;&#x2F;$&#123;&#123; secrets.GH_TOKEN &#125;&#125;@$&#123;&#123; secrets.GH_REF &#125;&#125;&quot; master:master</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>将博客的构建部署方式更换为Github Actions之后非常方便，有问题排查也很方便，到目前为止，感觉还是比较舒服的</p></div><div class="popular-posts-header">相关文章</div><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><a href="/hexo/use-sub-theme/" rel="bookmark">使用Git Submdule 分离Hexo主题</a></div></li></ul><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 青梅煮马</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://blog.yangfan16.cn/hexo/use-actions-github/" title="使用GitHub Actions 自动构建部署Hexo博客">https://blog.yangfan16.cn/hexo/use-actions-github/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/hexo/" rel="tag"><i class="fa fa-tag"></i> hexo</a></div><div class="post-widgets"><div class="wp_rating"><div id="wpac-rating"></div></div></div><div class="post-nav"><div class="post-nav-item"></div><div class="post-nav-item"> <a href="/hexo/use-sub-theme/" rel="next" title="使用Git Submdule 分离Hexo主题">使用Git Submdule 分离Hexo主题<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#关于GitHub-Actions"><span class="nav-number">1.</span> <span class="nav-text">关于GitHub Actions</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基本概念"><span class="nav-number">2.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#准备工作"><span class="nav-number">3.</span> <span class="nav-text">准备工作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#具体步骤"><span class="nav-number">4.</span> <span class="nav-text">具体步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#触发条件和运行环境"><span class="nav-number">4.1.</span> <span class="nav-text">触发条件和运行环境</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#检出代码和submodule"><span class="nav-number">4.2.</span> <span class="nav-text">检出代码和submodule</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装依赖"><span class="nav-number">4.3.</span> <span class="nav-text">安装依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#部署博客"><span class="nav-number">4.4.</span> <span class="nav-text">部署博客</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#完整配置文件"><span class="nav-number">4.5.</span> <span class="nav-text">完整配置文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结"><span class="nav-number">5.</span> <span class="nav-text">总结</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="青梅煮马" src="/uploads/avatar.png"><p class="site-author-name" itemprop="name">青梅煮马</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">4</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <span class="site-state-item-count">2</span> <span class="site-state-item-name">分类</span></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">2</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/yangfan16" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yangfan16" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:yangfan9915@gmail.com" title="E-Mail → mailto:yangfan9915@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://weibo.com/52012536" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;52012536" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span></div><div class="cc-license motion-element" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> 大佬博客链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="https://think2011.net/" title="https:&#x2F;&#x2F;think2011.net&#x2F;" rel="noopener" target="_blank">曾浩的博客</a></li><li class="links-of-blogroll-item"> <a href="https://ninghao.net/blog" title="https:&#x2F;&#x2F;ninghao.net&#x2F;blog" rel="noopener" target="_blank">王皓的博客</a></li></ul></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">京ICP备17005352号</a> <img src="/uploads/beian.png" style="display:inline-block"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=1234567890" rel="noopener" target="_blank">京公网安备 1234567890号</a></div><div class="copyright"> &copy; <span itemprop="copyrightYear">2020</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">青梅煮马</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span class="post-meta-item-text">站点总字数：</span> <span title="站点总字数">12k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span class="post-meta-item-text">站点阅读时长 &asymp;</span> <span title="站点阅读时长">11 分钟</span></div><div class="addthis_inline_share_toolbox"><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=c8de44fa2310d1ca" async="async"></script></div></div></footer></div><script size="200" alpha="0.4" zindex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/pjax/pjax.min.js"></script><script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script><script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script><script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.getAttribute('pjax') !== null) {
      script.setAttribute('pjax', '');
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script><script data-pjax>CONFIG.page.isPost&&(wpac_init=window.wpac_init||[],wpac_init.push({widget:"Rating",id:10254,el:"wpac-rating",color:"fc6423"}),function(){if(!("WIDGETPACK_LOADED"in window)){WIDGETPACK_LOADED=!0;var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//embed.widgetpack.com/widget.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t.nextSibling)}}())</script><div id="pjax"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'f9f42cb27214f7d10b14',
      clientSecret: '147d85755db76790cff0442b7f5123e0032cba08',
      repo        : 'gitalk',
      owner       : 'yangfan16',
      admin       : ['yangfan16'],
      id          : '5edbeb30eca07dd72348a72563af39b6',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></div></body></html>