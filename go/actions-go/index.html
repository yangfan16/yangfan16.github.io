<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/uploads/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/uploads/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/uploads/favicon-16x16.png"><link rel="mask-icon" href="/uploads/safari-pinned-tab.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"blog.yangfan16.cn",root:"/",scheme:"Mist",version:"7.8.0",exturl:!1,sidebar:{position:"right",display:"hide",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!0,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!0,lazyload:!0,pangu:!0,comments:{style:"buttons",active:"gitalk",storage:!0,lazyload:!1,nav:null,activeClass:"gitalk"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!1,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!0,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="欧老板昨天问我怎么让自己的go程序使用github-actions，给欧老板做了一个简单的demo， 一个beego的程序，随便写了点单测的代码。一个基本的 Pipeline，推送代码到 master 分支的时候就会触发该 Pipeline 的自动构建，进行代码的静态化检查操作、运行单元测试并使用 Codecov 生成代码覆盖率报告，部署到Netlify，并且根据Dockerfile生成Dock"><meta property="og:type" content="article"><meta property="og:title" content="GitHub Actions 自动化构建Go应用"><meta property="og:url" content="https://blog.yangfan16.cn/go/actions-go/index.html"><meta property="og:site_name" content="青梅梦呓"><meta property="og:description" content="欧老板昨天问我怎么让自己的go程序使用github-actions，给欧老板做了一个简单的demo， 一个beego的程序，随便写了点单测的代码。一个基本的 Pipeline，推送代码到 master 分支的时候就会触发该 Pipeline 的自动构建，进行代码的静态化检查操作、运行单元测试并使用 Codecov 生成代码覆盖率报告，部署到Netlify，并且根据Dockerfile生成Dock"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2020-05-07T00:09:14.000Z"><meta property="article:modified_time" content="2020-06-02T14:41:26.624Z"><meta property="article:author" content="青梅煮马"><meta property="article:tag" content="go"><meta property="article:tag" content="docker"><meta property="article:tag" content="github-actions"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://blog.yangfan16.cn/go/actions-go/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>GitHub Actions 自动化构建Go应用 | 青梅梦呓</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">青梅梦呓</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">和世界交手的这许多年，你是否光彩依旧，兴致盎然</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i> 首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i> 归档</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i> 标签</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i> 关于</a></li></ul></nav></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a> <a href="https://github.com/yangfan16" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.yangfan16.cn/go/actions-go/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/uploads/avatar.png"><meta itemprop="name" content="青梅煮马"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="青梅梦呓"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> GitHub Actions 自动化构建Go应用</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-05-07 08:09:14" itemprop="dateCreated datePublished" datetime="2020-05-07T08:09:14+08:00">2020-05-07</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/go/" itemprop="url" rel="index"><span itemprop="name">go</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>3.9k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span>4 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>欧老板昨天问我怎么让自己的go程序使用github-actions，给欧老板做了一个简单的demo， 一个beego的程序，随便写了点单测的代码。一个基本的 Pipeline，推送代码到 master 分支的时候就会触发该 Pipeline 的自动构建，进行代码的静态化检查操作、运行单元测试并使用 Codecov 生成代码覆盖率报告，部署到Netlify，并且根据Dockerfile生成Docker镜像。</p></blockquote><a id="more"></a><h2 id="Golang-项目"><a href="#Golang-项目" class="headerlink" title="Golang 项目"></a>Golang 项目</h2><h3 id="主程序"><a href="#主程序" class="headerlink" title="主程序"></a>主程序</h3><p>主要是为了演示GitHub Actions的功能，欧老板说他用的beego,我就构建一个最简单的”Hello world”的 beego 程序，其中就包含一个基本的 Pipeline，推送代码到 master 分支的时候就会触发该 Pipeline 的自动构建，进行代码的静态化检查操作、运行单元测试并使用 Codecov 生成代码覆盖率报告，部署到Netlify，并且根据Dockerfile生成Docker镜像。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// main.go的代码</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"github.com/astaxie/beego"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MainController <span class="keyword">struct</span> &#123;</span><br><span class="line">	beego.Controller</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *MainController)</span> <span class="title">Get</span><span class="params">()</span></span> &#123;</span><br><span class="line">	controller.Ctx.WriteString(<span class="string">"感谢欧阳老板给我机会，尽管老板你姓欧"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	beego.Router(<span class="string">"/"</span>, &amp;MainController&#123;&#125;)</span><br><span class="line">	beego.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h3><p>单测不知道该写什么，创建了hello的文件夹，在里面写了个最长前缀匹配的函数</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//hello.go的代码</span></span><br><span class="line"><span class="keyword">package</span> hello</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"strings"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// longestCommonPrefix LeetCode最长公共前缀</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">LongestCommonPrefix</span><span class="params">(strs []<span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(strs) &lt; <span class="number">1</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">""</span></span><br><span class="line">	&#125;</span><br><span class="line">	prefix := strs[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">for</span> _,k := <span class="keyword">range</span> strs &#123;</span><br><span class="line">		<span class="keyword">for</span> strings.Index(k,prefix) != <span class="number">0</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">len</span>(prefix) == <span class="number">0</span> &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="string">""</span></span><br><span class="line">			&#125;</span><br><span class="line">			prefix = prefix[:<span class="built_in">len</span>(prefix) - <span class="number">1</span>]</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> prefix</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// hello_test.go的代码</span></span><br><span class="line"><span class="keyword">package</span> hello</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"testing"</span></span><br><span class="line"></span><br><span class="line">	. <span class="string">"github.com/smartystreets/goconvey/convey"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//TestLongestCommonPrefix goconvey单测</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestLongestCommonPrefix</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">	Convey(<span class="string">"TestLongestCommonPrefix should return fl "</span>, t, <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		a := []<span class="keyword">string</span>&#123;<span class="string">"flower"</span>, <span class="string">"flow"</span>, <span class="string">"flight"</span>&#125;</span><br><span class="line">		So(LongestCommonPrefix(a), ShouldEqual, <span class="string">"fl"</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	Convey(<span class="string">"TestLongestCommonPrefix should return empty string "</span>, t, <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		b := []<span class="keyword">string</span>&#123;<span class="string">"dog"</span>, <span class="string">"racecar"</span>, <span class="string">"car"</span>&#125;</span><br><span class="line">		So(LongestCommonPrefix(b), ShouldEqual, <span class="string">""</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我一直使用<code>go modules</code>,生成依赖，最终的目录结构是下面这样的;我不太会写Makefile，所以直接就把Dockerfile放在了根目录下面。</p><p>.<br>└── actions-go-demo<br> ├── Dockerfile<br> ├── LICENSE<br> ├── README.md<br> ├── go.mod<br> ├── go.sum<br> ├── hello<br> │ ├── hello.go<br> │ └── hello_test.go<br> └── main.go</p><h2 id="Github-Action配置"><a href="#Github-Action配置" class="headerlink" title="Github Action配置"></a>Github Action配置</h2><h3 id="简单的构建"><a href="#简单的构建" class="headerlink" title="简单的构建"></a>简单的构建</h3><p>手写或者自动生成actions的配置文件<code>.github/workflows/go.yml</code>都可以。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">name: Beego</span><br><span class="line"></span><br><span class="line">on:</span><br><span class="line">  push:</span><br><span class="line">    branches: [ master ]</span><br><span class="line"></span><br><span class="line">env:</span><br><span class="line">  GOPROXY: "https://goproxy.cn"</span><br><span class="line">  GO111MODULE: "on"</span><br><span class="line"></span><br><span class="line">jobs:</span><br><span class="line"></span><br><span class="line">  build:</span><br><span class="line">    name: Build</span><br><span class="line">    runs-on: ubuntu-latest</span><br><span class="line">    steps:</span><br><span class="line"></span><br><span class="line">    - name: Set up Go 1.14</span><br><span class="line">      uses: actions/setup-go@v2</span><br><span class="line">      with:</span><br><span class="line">        go-version: ^1.14</span><br><span class="line">      id: go</span><br><span class="line"></span><br><span class="line">    - name: Check out code into the Go module directory</span><br><span class="line">      uses: actions/checkout@v2</span><br><span class="line"></span><br><span class="line">    - name: Cache Primes</span><br><span class="line">      uses: actions/cache@v1</span><br><span class="line">      with:</span><br><span class="line">        path: ~/go/pkg/mod</span><br><span class="line">        key: $&#123;&#123; runner.os &#125;&#125;-go-$&#123;&#123; hashFiles('**/go.sum') &#125;&#125;</span><br><span class="line">        restore-keys: |</span><br><span class="line">          $&#123;&#123; runner.os &#125;&#125;-go-</span><br><span class="line"></span><br><span class="line">    - name: Go Get dependencies and go module</span><br><span class="line">      run: |</span><br><span class="line">        go mod tidy</span><br><span class="line">        go get -v -t -d ./...</span><br><span class="line"></span><br><span class="line">    - name: Build</span><br><span class="line">      # 这里build 时交叉编译并设置使用所有内置库静态编译程序</span><br><span class="line">      # 方便最后一步做出的Docker镜像小一些</span><br><span class="line">      run: CGO_ENABLED=0 GOOS=linux go build -a -ldflags '-extldflags "-static"' -o main .</span><br><span class="line"></span><br><span class="line">    - name: Staticcheck</span><br><span class="line">      run: |</span><br><span class="line">        # https://github.com/actions/setup-go/issues/14</span><br><span class="line">        # 已经修复这个问题，直接go get 就行</span><br><span class="line">        # export PATH=$&#123;PATH&#125;:`go env GOPATH`/bin</span><br><span class="line">        go get -u honnef.co/go/tools/cmd/staticcheck</span><br><span class="line">        staticcheck ./...</span><br><span class="line"></span><br><span class="line">    - name: Test</span><br><span class="line">      run: |</span><br><span class="line">        go get -u github.com/smartystreets/goconvey</span><br><span class="line">        go test -v ./...</span><br><span class="line"></span><br><span class="line">    - name: Netlify deploy</span><br><span class="line">      env:</span><br><span class="line">        NETLIFY_TOKEN: $&#123;&#123; secrets.NETLIFY_TOKEN &#125;&#125;</span><br><span class="line">      run: |</span><br><span class="line">        ./netlifyctl -A $&#123;NETLIFY_TOKEN&#125; deploy || true</span><br><span class="line">        cat netlifyctl-debug.log || true</span><br><span class="line"></span><br><span class="line">     - name: Build the Docker image</span><br><span class="line">      run: |</span><br><span class="line">        docker login --username=$&#123;&#123; secrets.DOCKER_USN &#125;&#125; registry.ap-northeast-1.aliyuncs.com --password=$&#123;&#123; secrets.DOCKER_PWD &#125;&#125;</span><br><span class="line">        docker build -t beego:latest . #执行构建</span><br><span class="line">        docker tag beego registry.ap-northeast-1.aliyuncs.com/example/beego</span><br><span class="line">        docker push registry.ap-northeast-1.aliyuncs.com/example/beego:latest # 推送</span><br></pre></td></tr></table></figure><h3 id="Actions解析"><a href="#Actions解析" class="headerlink" title="Actions解析"></a>Actions解析</h3><h4 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a>设置环境变量</h4><p>现在使用的Go版本基本都在1.13以上，完全可以使用GoProxy，当然相对Github来说并不需要，完全可以不用设置这个环境变量。使用Go Module 来管理依赖，设置GO111MODULE为开启状态。</p><h4 id="设置缓存"><a href="#设置缓存" class="headerlink" title="设置缓存"></a>设置缓存</h4><p>即使使用Go Module，每次重新下载每个构建的依赖关系是真的浪费。Actions官方提供了一个缓存方式，也比较完备的说明了怎么使用，<a href="https://github.com/actions/cache" target="_blank" rel="noopener">具体移步这里</a>.</p><h4 id="Go-Build"><a href="#Go-Build" class="headerlink" title="Go Build"></a>Go Build</h4><p>使用交叉编译，并设置使用所有内置库静态编译程序，这样主要是为了下一步生成Docker镜像比较小。</p><h4 id="静态检查"><a href="#静态检查" class="headerlink" title="静态检查"></a>静态检查</h4><p>个人比较倾向于使用Staticcheck进行静态检查，如果同用使用这个就会出现构建失败的情况，国内有很多使用this 或者 self之类的语法糖，这种编译检查时候不会通过。需要去改一下名字。</p><h4 id="推送到阿里云"><a href="#推送到阿里云" class="headerlink" title="推送到阿里云"></a>推送到阿里云</h4><p>由于阿里云开始商业化，dockerhub与github又是无缝对接，直接吧编译好的文件推送到github上即可。我的仓库中删除了这部分。</p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>上述代码与配置均推送至我的github仓库，<a href="https://github.com/yangfan16/actions-go-demo" target="_blank" rel="noopener">可以在这里查看</a>。</p></div><div class="popular-posts-header">相关文章</div><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><a href="/go/go-map/" rel="bookmark">理解Go语言的哈希表</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/go/go-slice-array/" rel="bookmark">理解Go语言数组和切片</a></div></li></ul><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 青梅煮马</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://blog.yangfan16.cn/go/actions-go/" title="GitHub Actions 自动化构建Go应用">https://blog.yangfan16.cn/go/actions-go/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/go/" rel="tag"><i class="fa fa-tag"></i> go</a></div><div class="post-widgets"><div class="wp_rating"><div id="wpac-rating"></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/go/go-slice-array/" rel="prev" title="理解Go语言数组和切片"><i class="fa fa-chevron-left"></i> 理解Go语言数组和切片</a></div><div class="post-nav-item"> <a href="/docker/docker-container/" rel="next" title="重学Docker之容器（二）">重学Docker之容器（二）<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Golang-项目"><span class="nav-number">1.</span> <span class="nav-text">Golang 项目</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#主程序"><span class="nav-number">1.1.</span> <span class="nav-text">主程序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#单元测试"><span class="nav-number">1.2.</span> <span class="nav-text">单元测试</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Github-Action配置"><span class="nav-number">2.</span> <span class="nav-text">Github Action配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简单的构建"><span class="nav-number">2.1.</span> <span class="nav-text">简单的构建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Actions解析"><span class="nav-number">2.2.</span> <span class="nav-text">Actions解析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#设置环境变量"><span class="nav-number">2.2.1.</span> <span class="nav-text">设置环境变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#设置缓存"><span class="nav-number">2.2.2.</span> <span class="nav-text">设置缓存</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Go-Build"><span class="nav-number">2.2.3.</span> <span class="nav-text">Go Build</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#静态检查"><span class="nav-number">2.2.4.</span> <span class="nav-text">静态检查</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#推送到阿里云"><span class="nav-number">2.2.5.</span> <span class="nav-text">推送到阿里云</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#代码"><span class="nav-number">2.3.</span> <span class="nav-text">代码</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="青梅煮马" src="/uploads/avatar.png"><p class="site-author-name" itemprop="name">青梅煮马</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">13</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <span class="site-state-item-count">6</span> <span class="site-state-item-name">分类</span></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">8</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/yangfan16" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yangfan16" rel="noopener" target="_blank"><i class="github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:yangfan9915@gmail.com" title="E-Mail → mailto:yangfan9915@gmail.com" rel="noopener" target="_blank"><i class="envelope fa-fw"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://weibo.com/52012536" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;52012536" rel="noopener" target="_blank"><i class="weibo fa-fw"></i> Weibo</a></span></div><div class="cc-license motion-element" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="link fa-fw"></i> 大佬博客链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="https://think2011.net/" title="https:&#x2F;&#x2F;think2011.net&#x2F;" rel="noopener" target="_blank">曾浩的博客</a></li><li class="links-of-blogroll-item"> <a href="https://ninghao.net/blog" title="https:&#x2F;&#x2F;ninghao.net&#x2F;blog" rel="noopener" target="_blank">王皓的博客</a></li></ul></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">京ICP备17005352号-2</a> <img src="/uploads/beian.png" style="display:inline-block"></div><div class="copyright"> &copy; <span itemprop="copyrightYear">2020</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">青梅煮马</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-chart-area"></i></span> <span class="post-meta-item-text">站点总字数：</span> <span title="站点总字数">88k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span class="post-meta-item-text">站点阅读时长 &asymp;</span> <span title="站点阅读时长">1:20</span></div><div class="addthis_inline_share_toolbox"><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e79f11b160a4070" async="async"></script></div></div></footer></div><script size="200" alpha="0.4" zindex="-1" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-ribbon@1/canvas-ribbon.js"></script><script src="//cdn.jsdelivr.net/npm/animejs@3.1.0/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-pjax@0/pjax.min.js"></script><script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/lozad.js/1.14.0/lozad.min.js"></script><script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script><script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script><script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script><script data-pjax>CONFIG.page.isPost&&(wpac_init=window.wpac_init||[],wpac_init.push({widget:"Rating",id:10254,el:"wpac-rating",color:"fc6423"}),function(){if(!("WIDGETPACK_LOADED"in window)){WIDGETPACK_LOADED=!0;var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//embed.widgetpack.com/widget.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t.nextSibling)}}())</script><div id="pjax"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'f9f42cb27214f7d10b14',
      clientSecret: '147d85755db76790cff0442b7f5123e0032cba08',
      repo        : 'gitalk',
      owner       : 'yangfan16',
      admin       : ['yangfan16'],
      id          : 'bdccadf2cd3a7eb82b575ed16d5a9760',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></div></body></html>