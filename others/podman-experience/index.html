<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/uploads/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/uploads/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/uploads/favicon-16x16.png"><link rel="mask-icon" href="/uploads/safari-pinned-tab.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"blog.yangfan16.cn",root:"/",scheme:"Mist",version:"7.8.0",exturl:!1,sidebar:{position:"right",display:"hide",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!0,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!0,lazyload:!0,pangu:!0,comments:{style:"buttons",active:"gitalk",storage:!0,lazyload:!1,nav:null,activeClass:"gitalk"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!1,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!0,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="最近把自己的虚拟机升级到了CetnOS 8,内核版本4.18.0-147.8.1.el8_1.x86_64，感觉带来的变化还是很大，网络管理彻底替换了 network.service，防火墙管理等等。居然还去Docker，引进了新一代的容器管理工具（😢 国内很多开发都还没用docker，就已经去docker了）,使用 Podman、Buildah(提供构建image的能力)、Skopeo(提供"><meta property="og:type" content="article"><meta property="og:title" content="Podman 初体验"><meta property="og:url" content="https://blog.yangfan16.cn/others/podman-experience/index.html"><meta property="og:site_name" content="青梅梦呓"><meta property="og:description" content="最近把自己的虚拟机升级到了CetnOS 8,内核版本4.18.0-147.8.1.el8_1.x86_64，感觉带来的变化还是很大，网络管理彻底替换了 network.service，防火墙管理等等。居然还去Docker，引进了新一代的容器管理工具（😢 国内很多开发都还没用docker，就已经去docker了）,使用 Podman、Buildah(提供构建image的能力)、Skopeo(提供"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://images.yangfan16.cn/podman-pod.jpeg"><meta property="article:published_time" content="2020-05-04T06:09:14.000Z"><meta property="article:modified_time" content="2020-06-02T14:41:26.628Z"><meta property="article:author" content="青梅煮马"><meta property="article:tag" content="docker"><meta property="article:tag" content="podman"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://images.yangfan16.cn/podman-pod.jpeg"><link rel="canonical" href="https://blog.yangfan16.cn/others/podman-experience/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>Podman 初体验 | 青梅梦呓</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">青梅梦呓</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">和世界交手的这许多年，你是否光彩依旧，兴致盎然</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i> 首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i> 归档</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i> 标签</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i> 关于</a></li></ul></nav></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a> <a href="https://github.com/yangfan16" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.yangfan16.cn/others/podman-experience/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/uploads/avatar.png"><meta itemprop="name" content="青梅煮马"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="青梅梦呓"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Podman 初体验</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-05-04 14:09:14" itemprop="dateCreated datePublished" datetime="2020-05-04T14:09:14+08:00">2020-05-04</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/others/" itemprop="url" rel="index"><span itemprop="name">others</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>13k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span>11 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>最近把自己的虚拟机升级到了CetnOS 8,内核版本4.18.0-147.8.1.el8_1.x86_64，感觉带来的变化还是很大，网络管理彻底替换了 network.service，防火墙管理等等。居然还去Docker，引进了新一代的容器管理工具（😢 国内很多开发都还没用docker，就已经去docker了）,使用 Podman、Buildah(提供构建image的能力)、Skopeo(提供远程仓库的镜像管理能力) ,对docker进行了替换。 我体验了下 Podman,谨做小文以记。</p></blockquote><a id="more"></a><h3 id="为啥不用Docker"><a href="#为啥不用Docker" class="headerlink" title="为啥不用Docker"></a>为啥不用Docker</h3><p>我觉得主要是因为docker需要运行一个守护进程，docker的稳定性问题（感觉在向好的趋势不断发展，其实远比podman稳定多了），还有的话就是root运行。随着K8S抛弃CRI标准，CRI-O进入CNCF孵化阶段,国外越来越多的在使用CRI-O 来替代Docker,Docker正在被大家抛弃 (:–</p><h3 id="podman特色"><a href="#podman特色" class="headerlink" title="podman特色"></a>podman特色</h3><h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><p>podman创建容器不需要守护进程，可以用普通用户创建容器。podman的命令方式与docker没有什么太大的区别，可以认为 alias docker=podman，会用docker就会用podman。</p><h4 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h4><ul><li>有一个podman-compose(但是还没有release1.0)，不是很好用。与docker-compose还有很大的差距。</li><li>更新频繁(你永远不知道这个锅是你的问题还是podman的问题，心累)</li></ul><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>CenOS8默认就是podman，docker安装反倒是需要去安装仓库源。 直接运行<code>sudo yum install podman -y</code>就行</p><p><code>yum info podman</code> 能看到以下信息</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">名称         : podman</span><br><span class="line">版本         : 1.6.4</span><br><span class="line">发布         : 4.module_el8.1.0+298+41f9343a</span><br><span class="line">架构         : x86_64</span><br><span class="line">大小         : 55 M</span><br><span class="line">源           : podman-1.6.4-4.module_el8.1.0+298+41f9343a.src.rpm</span><br><span class="line">仓库         : @System</span><br><span class="line">来自仓库     : AppStream</span><br><span class="line">概况         : Manage Pods, Containers and Container Images</span><br><span class="line">URL          : https://podman.io/</span><br><span class="line">协议         : ASL 2.0</span><br><span class="line">描述         : podman (Pod Manager) is a fully featured container engine that is a simple daemonless tool.  podman provides a Docker-CLI</span><br><span class="line">             : comparable command line that eases the transition from other container engines and allows the management of pods, containers and</span><br><span class="line">             : images.  Simply put: alias docker=podman.  Most podman commands can be run as a regular user, without requiring additional</span><br><span class="line">             : privileges.</span><br><span class="line">             :</span><br><span class="line">             : podman uses Buildah(1) internally to create container images. Both tools share image (not container) storage, hence each can use</span><br><span class="line">             : or manipulate images (but not containers) created by the other.</span><br><span class="line">             :</span><br><span class="line">             : Manage Pods, Containers and Container Images</span><br><span class="line">             : libpod Simple management tool for pods, containers and images</span><br></pre></td></tr></table></figure><h3 id="配置说明"><a href="#配置说明" class="headerlink" title="配置说明"></a>配置说明</h3><h4 id="podman-rpm中附带的文件"><a href="#podman-rpm中附带的文件" class="headerlink" title="podman rpm中附带的文件"></a>podman rpm中附带的文件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> rpm -ql podman | grep -v <span class="string">"/usr/share/doc/"</span></span></span><br><span class="line">/etc/cni/net.d/87-podman-bridge.conflist</span><br><span class="line">/usr/bin/podman</span><br><span class="line">/usr/lib/.build-id</span><br><span class="line">/usr/lib/.build-id/82</span><br><span class="line">/usr/lib/.build-id/82/21ca637b743ef63235a38b3195f6563a96967a</span><br><span class="line">/usr/lib/systemd/system/io.podman.service</span><br><span class="line">/usr/lib/systemd/system/io.podman.socket</span><br><span class="line">/usr/lib/systemd/user/io.podman.service</span><br><span class="line">/usr/lib/systemd/user/io.podman.socket</span><br><span class="line">/usr/lib/tmpfiles.d/podman.conf</span><br><span class="line">/usr/share/bash-completion/completions/podman</span><br><span class="line">/usr/share/containers/libpod.conf</span><br><span class="line">/usr/share/licenses/podman</span><br><span class="line">/usr/share/licenses/podman/LICENSE</span><br><span class="line">/usr/share/man/man5/oci-hooks.5.gz</span><br><span class="line">/usr/share/zsh/site-functions</span><br><span class="line">/usr/share/zsh/site-functions/_podman</span><br></pre></td></tr></table></figure><p>能看到的只有一个配置文件，就在<code>/etc/cni/net.d/</code>下面,与Bridge的配置有关,打开看看：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">$ cat &#x2F;etc&#x2F;cni&#x2F;net.d&#x2F;87-podman-bridge.conflist</span><br><span class="line">&#123;</span><br><span class="line">  &quot;cniVersion&quot;: &quot;0.4.0&quot;,</span><br><span class="line">  &quot;name&quot;: &quot;podman&quot;,</span><br><span class="line">  &quot;plugins&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;type&quot;: &quot;bridge&quot;,</span><br><span class="line">      &quot;bridge&quot;: &quot;cni-podman0&quot;,</span><br><span class="line">      &quot;isGateway&quot;: true,</span><br><span class="line">      &quot;ipMasq&quot;: true,</span><br><span class="line">      &quot;ipam&quot;: &#123;</span><br><span class="line">        &quot;type&quot;: &quot;host-local&quot;,</span><br><span class="line">        &quot;routes&quot;: [&#123; &quot;dst&quot;: &quot;0.0.0.0&#x2F;0&quot; &#125;],</span><br><span class="line">        &quot;ranges&quot;: [</span><br><span class="line">          [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;subnet&quot;: &quot;10.88.0.0&#x2F;16&quot;,</span><br><span class="line">              &quot;gateway&quot;: &quot;10.88.0.1&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;type&quot;: &quot;portmap&quot;,</span><br><span class="line">      &quot;capabilities&quot;: &#123;</span><br><span class="line">        &quot;portMappings&quot;: true</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;type&quot;: &quot;tuning&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然而安装的时候，能看到需要的一个重要依赖就是containers-common，这个里面有很多配置文件。<br><code>rpm -ql containers-common | grep -v &quot;/usr/share/man/&quot;</code> 可以查看具体的文件信息。</p><h4 id="registries-conf"><a href="#registries-conf" class="headerlink" title="registries.conf"></a>registries.conf</h4><p><code>/etc/containers/registries.conf</code> 用于保存 registries 相关配置：</p><h4 id="mounts-conf"><a href="#mounts-conf" class="headerlink" title="mounts.conf"></a>mounts.conf</h4><p>这个配置指定在执行 podman run 或者 podman build 命令时自动挂载的路径，该路径只会在容器运行时挂载，不会提交到容器镜像中。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cat /usr/share/containers/mounts.conf</span></span><br><span class="line">/usr/share/rhel/secrets:/run/secrets</span><br></pre></td></tr></table></figure><h4 id="policy-json"><a href="#policy-json" class="headerlink" title="policy.json"></a>policy.json</h4><p>证书相关的配置</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cat /etc/containers/policy.json</span></span><br><span class="line">&#123;</span><br><span class="line">    "default": [</span><br><span class="line">        &#123;</span><br><span class="line">            "type": "insecureAcceptAnything"</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    "transports":</span><br><span class="line">        &#123;</span><br><span class="line">            "docker-daemon":</span><br><span class="line">                &#123;</span><br><span class="line">                    "": [&#123;"type":"insecureAcceptAnything"&#125;]</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="images使用"><a href="#images使用" class="headerlink" title="images使用"></a>images使用</h3><blockquote><p>Ps:以下操作已经使得虚拟机可以科学上网，终端已经<code>export https_proxy</code><br>PPs: 我修改了下仓库，如下</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cat  /etc/containers/registries.conf</span></span><br><span class="line">......</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 仅仅改了下面部分</span></span><br><span class="line">[registries.search]</span><br><span class="line"><span class="meta">#</span><span class="bash">registries = [<span class="string">'registry.access.redhat.com'</span>, <span class="string">'registry.fedoraproject.org'</span>, <span class="string">'registry.centos.org'</span>, <span class="string">'docker.io'</span>]</span></span><br><span class="line">registries = ['registry.redhat.io','quay.io','docker.io','registry.access.redhat.com']</span><br><span class="line"></span><br><span class="line">......</span><br></pre></td></tr></table></figure><h4 id="搜索镜像"><a href="#搜索镜像" class="headerlink" title="搜索镜像"></a>搜索镜像</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ podman search nginx | head -6</span><br><span class="line">INDEX        NAME                                                                   DESCRIPTION                                       STARS   OFFICIAL   AUTOMATED</span><br><span class="line">redhat.io    registry.redhat.io&#x2F;rhscl&#x2F;nginx-112-rhel7                               Nginx is a web server and a reverse proxy se...   0</span><br><span class="line">redhat.io    registry.redhat.io&#x2F;rhel8&#x2F;nginx-116                                     Platform for running nginx 1.16 or building ...   0</span><br><span class="line">redhat.io    registry.redhat.io&#x2F;rhel8&#x2F;nginx-114                                     Nginx is a web server and a reverse proxy se...   0</span><br><span class="line">redhat.io    registry.redhat.io&#x2F;rhscl&#x2F;nginx-18-rhel7                                Nginx 1.8 server and a reverse proxy server       0</span><br><span class="line">redhat.io    registry.redhat.io&#x2F;rhscl&#x2F;nginx-110-rhel7                               Nginx container image that delivers an nginx...   0</span><br></pre></td></tr></table></figure><h4 id="构建镜像"><a href="#构建镜像" class="headerlink" title="构建镜像"></a>构建镜像</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir -p $HOME&#x2F;padmon&#x2F;hello</span><br><span class="line">$ cd $HOME&#x2F;podman&#x2F;hello</span><br><span class="line">$ cat Dockerfile</span><br><span class="line">FROM docker.io&#x2F;library&#x2F;ubuntu:latest</span><br><span class="line"></span><br><span class="line">RUN echo &#39;hello&#39;</span><br><span class="line"># 第一次构建出错 </span><br><span class="line">podman build -t hello:1.0 .</span><br><span class="line">STEP 1: FROM docker.io&#x2F;library&#x2F;ubuntu:latest</span><br><span class="line">Getting image source signatures</span><br><span class="line">Copying blob fee5db0ff82f done</span><br><span class="line">Copying blob fc878cd0a91c done</span><br><span class="line">Copying blob d51af753c3d3 done</span><br><span class="line">Copying blob 6154df8ff988 done</span><br><span class="line">Error: error creating build container: Error writing blob: error storing blob to file &quot;&#x2F;var&#x2F;tmp&#x2F;storage169362295&#x2F;3&quot;: unexpected EOF</span><br><span class="line"># 我啥都没干，重新试了一下</span><br><span class="line">$ podman build -t hello:1.0 .</span><br><span class="line">STEP 1: FROM docker.io&#x2F;library&#x2F;ubuntu:latest</span><br><span class="line">Getting image source signatures</span><br><span class="line">Copying blob 6154df8ff988 done</span><br><span class="line">Copying blob d51af753c3d3 done</span><br><span class="line">Copying blob fee5db0ff82f done</span><br><span class="line">Copying blob fc878cd0a91c done</span><br><span class="line">Copying config 1d622ef86b done</span><br><span class="line">Writing manifest to image destination</span><br><span class="line">Storing signatures</span><br><span class="line">STEP 2: RUN echo &#39;hello&#39;</span><br><span class="line">hello</span><br><span class="line">STEP 3: COMMIT hello:1.0</span><br><span class="line">58013a9566306982c614d34f74ba6c658182a640e4fd31bd9a69698791b2f782</span><br><span class="line">$ podman images</span><br><span class="line">REPOSITORY                 TAG      IMAGE ID       CREATED              SIZE</span><br><span class="line">localhost&#x2F;hello            1.0      58013a956630   About a minute ago   76.3 MB</span><br><span class="line">docker.io&#x2F;library&#x2F;ubuntu   latest   1d622ef86b13   10 days ago          76.3 MB</span><br></pre></td></tr></table></figure><h4 id="拉取"><a href="#拉取" class="headerlink" title="拉取"></a>拉取</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">podman image pull nginx</span><br><span class="line"><span class="meta">#</span><span class="bash">前两次失败，啥也没干，第三次成功 失败的原因是unexpected EOF</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 从github的issue上来看显然不是我一个人人品不行,多尝试几次，有时候会成功。</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> podman images</span></span><br><span class="line">REPOSITORY                 TAG      IMAGE ID       CREATED         SIZE</span><br><span class="line">localhost/hello            1.0      58013a956630   9 minutes ago   76.3 MB</span><br><span class="line">docker.io/library/ubuntu   latest   1d622ef86b13   10 days ago     76.3 MB</span><br><span class="line">docker.io/library/nginx    latest   602e111c06b6   11 days ago     131 MB</span><br></pre></td></tr></table></figure><p>除了像 Docker 一样从网络拉取镜像，Podman 为了方便用户从 Docker 迁移过来，Podman 支持从本地的 docker daemon 中直接拉取镜像，如果没有 domain 的话，目前会自动补全 docker.io/library/ 前缀。</p><h4 id="检查和删除"><a href="#检查和删除" class="headerlink" title="检查和删除"></a>检查和删除</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$ podman image inspect docker.io&#x2F;library&#x2F;nginx |head -n 15</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Id&quot;: &quot;602e111c06b6934013578ad80554a074049c59441d9bcd963cb4a7feccede7a5&quot;,</span><br><span class="line">        &quot;Digest&quot;: &quot;sha256:86ae264c3f4acb99b2dee4d0098c40cb8c46dcf9e1148f05d3a51c4df6758c12&quot;,</span><br><span class="line">        &quot;RepoTags&quot;: [</span><br><span class="line">            &quot;docker.io&#x2F;library&#x2F;nginx:latest&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;RepoDigests&quot;: [</span><br><span class="line">            &quot;docker.io&#x2F;library&#x2F;nginx@sha256:86ae264c3f4acb99b2dee4d0098c40cb8c46dcf9e1148f05d3a51c4df6758c12&quot;,</span><br><span class="line">            &quot;docker.io&#x2F;library&#x2F;nginx@sha256:cccef6d6bdea671c394956e24b0d0c44cd82dbe83f543a47fdc790fadea48422&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;Parent&quot;: &quot;&quot;,</span><br><span class="line">        &quot;Comment&quot;: &quot;&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2020-04-23T13:03:01.355887897Z&quot;,</span><br><span class="line">        &quot;Config&quot;: &#123;</span><br><span class="line">        </span><br><span class="line">$ podman image rm docker.io&#x2F;library&#x2F;nginx</span><br><span class="line">Untagged: docker.io&#x2F;library&#x2F;nginx:latest</span><br><span class="line">Deleted: 602e111c06b6934013578ad80554a074049c59441d9bcd963cb4a7feccede7a5</span><br><span class="line"></span><br><span class="line">$ podman images</span><br><span class="line">REPOSITORY                 TAG      IMAGE ID       CREATED          SIZE</span><br><span class="line">localhost&#x2F;hello            1.0      58013a956630   11 minutes ago   76.3 MB</span><br><span class="line">docker.io&#x2F;library&#x2F;ubuntu   latest   1d622ef86b13   10 days ago      76.3 MB</span><br></pre></td></tr></table></figure><h3 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h3><h4 id="运行-停止和删除"><a href="#运行-停止和删除" class="headerlink" title="运行,停止和删除"></a>运行,停止和删除</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> podman images</span></span><br><span class="line">REPOSITORY                 TAG      IMAGE ID       CREATED          SIZE</span><br><span class="line">localhost/hello            1.0      58013a956630   13 minutes ago   76.3 MB</span><br><span class="line">docker.io/library/ubuntu   latest   1d622ef86b13   10 days ago      76.3 MB</span><br><span class="line">docker.io/library/nginx    latest   602e111c06b6   11 days ago      131 MB</span><br><span class="line"><span class="meta">$</span><span class="bash"> podman run -it docker.io/library/ubuntu sh</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cat /etc/issue</span></span><br><span class="line">Ubuntu 20.04 LTS \n \l</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">exit</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> podman ps -a</span></span><br><span class="line">CONTAINER ID  IMAGE                            COMMAND  CREATED        STATUS                         PORTS  NAMES</span><br><span class="line">6e20cab0d0dc  docker.io/library/ubuntu:latest  sh       2 minutes ago  Exited (0) About a minute ago         gallant_wright</span><br><span class="line"><span class="meta">$</span><span class="bash"> podman ps</span></span><br><span class="line">CONTAINER ID  IMAGE                            COMMAND  CREATED        STATUS            PORTS  NAMES</span><br><span class="line">4dffd4d2a97d  docker.io/library/ubuntu:latest  sh       3 seconds ago  Up 3 seconds ago         modest_dewdney</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> podman stop 4dffd4d2a97d</span></span><br><span class="line">4dffd4d2a97d079de9b777813b379fee66ed3b38b889545f764500032aefb1ec</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> podman rm 4dffd4d2a97d 6e20cab0d0dc</span></span><br><span class="line">4dffd4d2a97d079de9b777813b379fee66ed3b38b889545f764500032aefb1ec</span><br><span class="line">6e20cab0d0dc2007c51dc84fd2b3bd00caea2aa514b0e4f417646ba525ad5b16</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> podman ps -a</span></span><br><span class="line">CONTAINER ID  IMAGE  COMMAND  CREATED  STATUS  PORTS  NAMES</span><br></pre></td></tr></table></figure><h3 id="checkpoint-restore"><a href="#checkpoint-restore" class="headerlink" title="checkpoint/restore"></a>checkpoint/restore</h3><p>Podman 提供了类似于 git 的功能，能够对 container 进行 checkpoint(commit)，并且可以 restore(checkout)，<a href="https://asciinema.org/a/FsTbx9mZkzeuhCM2pFOr1tujM" target="_blank" rel="noopener">看着很美好的样子</a>，我到这里已经不是很想验证了，毕竟构建或者拉取这样基础的操作都要靠人品，还是等子弹先飞一会儿再说。</p><h3 id="健康检查"><a href="#健康检查" class="headerlink" title="健康检查"></a>健康检查</h3><p>podman提供了healthcheck功能，在运行容器时，可以通过参数<code>--healthcheck-command</code>来指定健康检查的方式，然后通过<code>podman healthcheck</code>命令来检测</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ podman run -dt --name healthtest --healthcheck-command &#39;CMD-SHELL curl https:&#x2F;&#x2F;www.baidu.com || exit 1&#39; --healthcheck-interval&#x3D;0 nginx:latest</span><br><span class="line">b3fa86705f2acfb59bcaa8bbed0a531e6fa17092593768a66bec56ba98623550</span><br><span class="line">$ podman healthcheck run healthtest</span><br><span class="line">unhealthy</span><br></pre></td></tr></table></figure><p>我到现在没明白我运行容器不健康的原因，我看了一堆issue，貌似各种说法不一，没有再深究下去。</p><h3 id="systemd"><a href="#systemd" class="headerlink" title="systemd"></a>systemd</h3><p>Podman没有daemon，没办法像docker一样通过指定参数<code>--restart=always</code>在docker进程启动时自动拉起镜像。 而采用systemd来支持该功能。</p><p>到这里我已经无力吐槽，完全没有再实验的动力了，暂时先空着吧，或许以后有机会我又会变心喜欢也有可能呢，到时候再研究这个怎么玩。</p><h3 id="Pod"><a href="#Pod" class="headerlink" title="Pod"></a>Pod</h3><p>总得对得起名字啊，主要不就是为了吹k8s pod概念嘛（： 根据podman自己的目标和说法，对于最终要运行在k8s环境的来说，Podman非常适合，能很大的减少环境不通导致的工作量，Podman的YAML和k8s pod yaml文件格式是兼容的。</p><p><img data-src="https://images.yangfan16.cn/podman-pod.jpeg" alt="podman pod架构"></p><h4 id="先创建一个pod"><a href="#先创建一个pod" class="headerlink" title="先创建一个pod"></a>先创建一个pod</h4><p>瞅瞅帮助命令， 基本上想要的都还有。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> podman pod --<span class="built_in">help</span></span></span><br><span class="line">Manage pods</span><br><span class="line"></span><br><span class="line">Description:</span><br><span class="line">  Pods are a group of one or more containers sharing the same network, pid and ipc namespaces.</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  podman pod [command]</span><br><span class="line"></span><br><span class="line">Available Commands:</span><br><span class="line">  create      Create a new empty pod</span><br><span class="line">  exists      Check if a pod exists in local storage</span><br><span class="line">  inspect     Displays a pod configuration</span><br><span class="line">  kill        Send the specified signal or SIGKILL to containers in pod</span><br><span class="line">  pause       Pause one or more pods</span><br><span class="line">  prune       Remove all stopped pods</span><br><span class="line">  ps          List pods</span><br><span class="line">  restart     Restart one or more pods</span><br><span class="line">  rm          Remove one or more pods</span><br><span class="line">  start       Start one or more pods</span><br><span class="line">  stats       Display a live stream of resource usage statistics for the containers in one or more pods</span><br><span class="line">  stop        Stop one or more pods</span><br><span class="line">  top         Display the running processes of containers in a pod</span><br><span class="line">  unpause     Unpause one or more pods</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> podman pod create --<span class="built_in">help</span></span></span><br><span class="line">Create a new empty pod</span><br><span class="line"></span><br><span class="line">Description:</span><br><span class="line">  After creating the pod, the pod ID is printed to stdout.</span><br><span class="line"></span><br><span class="line">  You can then start it at any time with the  podman pod start &lt;pod_id&gt; command. The pod will be created with the initial state 'created'.</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  podman pod create [flags]</span><br><span class="line"></span><br><span class="line">Flags:</span><br><span class="line">      --cgroup-parent string   Set parent cgroup for the pod</span><br><span class="line">      --hostname string        Set a hostname to the pod</span><br><span class="line">      --infra                  Create an infra container associated with the pod to share namespaces with (default true)</span><br><span class="line">      --infra-command string   The command to run on the infra container when the pod is started (default "/pause")</span><br><span class="line">      --infra-image string     The image of the infra container to associate with the pod (default "k8s.gcr.io/pause:3.1")</span><br><span class="line">  -l, --label strings          Set metadata on pod (default [])</span><br><span class="line">      --label-file strings     Read in a line delimited file of labels</span><br><span class="line">  -n, --name string            Assign a name to the pod</span><br><span class="line">      --pod-id-file string     Write the pod ID to the file</span><br><span class="line">  -p, --publish strings        Publish a container's port, or a range of ports, to the host (default [])</span><br><span class="line">      --share string           A comma delimited list of kernel namespaces the pod will share (default "cgroup,ipc,net,uts")</span><br></pre></td></tr></table></figure><p>创建一个pod, 由于重新打开了终端窗口失去了科学上网的proxy,第一次timeout了，一顿操作后创建成功了。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> podman pod create --name test_stack</span></span><br><span class="line">217143af2d6a44fe4fee99263d01bf26ca6cf287e62b4d3807fa968daea8ef7f</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> podman run -dt --pod new:web_server -p 8080:80 nginx</span></span><br><span class="line">e6336a56d0f217adb9938142fd0e1d98dd4b733140b7c88f4825359c096c4d3a</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> podman pod list</span></span><br><span class="line">POD ID         NAME         STATUS    CREATED          # OF CONTAINERS   INFRA ID</span><br><span class="line">01e985f62511   web_server   Running   7 seconds ago    2                 ae0341aac4c7</span><br><span class="line">9474f961f6e9   test_stack   Created   50 seconds ago   1                 ce0c41bf1c79</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> podman pod ps</span></span><br><span class="line">POD ID         NAME         STATUS    CREATED         # OF CONTAINERS   INFRA ID</span><br><span class="line">01e985f62511   web_server   Running   2 minutes ago   2                 ae0341aac4c7</span><br><span class="line">9474f961f6e9   test_stack   Created   2 minutes ago   1                 ce0c41bf1c79</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> curl localhost -I</span></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Length: 612</span><br><span class="line">Accept-Ranges: bytes</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Type: text/html</span><br><span class="line">Date: Mon, 04 May 2020 13:43:33 GMT</span><br><span class="line">Etag: "5e95c66e-264"</span><br><span class="line">Keep-Alive: timeout=4</span><br><span class="line">Last-Modified: Tue, 14 Apr 2020 14:19:26 GMT</span><br><span class="line">Proxy-Connection: keep-alive</span><br><span class="line">Server: nginx/1.17.10</span><br></pre></td></tr></table></figure><p>创建了两个pod节点，web_server这个pod中有一个容器nginx，并且暴露端口给外面，通过curl可以很轻易的验证是否正常工作。也可以检查根据端口查看哪个进程在使用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ss -tplun | grep 80</span></span><br><span class="line">tcp   LISTEN  0       1                    0.0.0.0:80           0.0.0.0:*      users:(("slirp4netns",pid=28816,fd=8))</span><br></pre></td></tr></table></figure><p>但是坑爹是的我stop这个pod，想要再次起来却始终无法起来。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> podman pod start web_server</span></span><br><span class="line">ERRO[0000] "error starting some containers: container already exists"</span><br><span class="line">ERRO[0000] "error from slirp4netns while setting up port redirection: map[desc:bad request: add_hostfwd: slirp_add_hostfwd failed]"</span><br><span class="line">Error: a dependency of container e6336a56d0f217adb9938142fd0e1d98dd4b733140b7c88f4825359c096c4d3a failed to start: container state improper</span><br></pre></td></tr></table></figure><p>emmmm,我理解新东西坑多点，但这个真的不是很好用啊。一开始还有给提issue的想法，现在完全没有一点意愿做这件事，而且在解决问题的过程中，能看到不少issue和我遇到的是相同的问题，都被粗暴的关闭了。</p><h3 id="k8s联动"><a href="#k8s联动" class="headerlink" title="k8s联动"></a>k8s联动</h3><p>通过<code>podman generate</code>命令可以生成k8s可用的YAML文件，使用<code>podman play</code>命令可以直接创建完整的 Pod 及其所拥有的容器。 但是这个还是遇到了一个<code>no matching entries in passwd file</code>。 我没有继续尝试下去的勇气😔</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>如果从Docker迁移过来，估计大半还是要抓狂：</p><ol><li>缺少国内镜像源，没有科学上网，什么都做不了，即使有，也要看运气。</li><li>说好了rootless, 但是你要是想对端口映射，还是得老老实实的sudo,否则就是各种各样的问题。</li><li>各种不稳定，编译失败，拉取失败，启动pod失败，关闭pod失败，关键是很多错误根本就不知道自己错在了哪里，过一会儿又会成功。</li><li>还需要更多地用户去采坑，去修复更多地问题。</li><li>文档资源稀缺，几乎全是英文的，而且都是很简单的示例，不知道能不能经受的生产环境的各种考验。</li></ol><p>总体来说，现在没有docker香，以后返回来看就不好说了。</p></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 青梅煮马</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://blog.yangfan16.cn/others/podman-experience/" title="Podman 初体验">https://blog.yangfan16.cn/others/podman-experience/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/podman/" rel="tag"><i class="fa fa-tag"></i> podman</a></div><div class="post-widgets"><div class="wp_rating"><div id="wpac-rating"></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/docker/docker-images/" rel="prev" title="重学Docker之镜像（一）"><i class="fa fa-chevron-left"></i> 重学Docker之镜像（一）</a></div><div class="post-nav-item"> <a href="/python/wechat-pics/" rel="next" title="Python爬取微信公众号上的图片">Python爬取微信公众号上的图片<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#为啥不用Docker"><span class="nav-number">1.</span> <span class="nav-text">为啥不用Docker</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#podman特色"><span class="nav-number">2.</span> <span class="nav-text">podman特色</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#优点"><span class="nav-number">2.1.</span> <span class="nav-text">优点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#缺点"><span class="nav-number">2.2.</span> <span class="nav-text">缺点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装"><span class="nav-number">3.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置说明"><span class="nav-number">4.</span> <span class="nav-text">配置说明</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#podman-rpm中附带的文件"><span class="nav-number">4.1.</span> <span class="nav-text">podman rpm中附带的文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#registries-conf"><span class="nav-number">4.2.</span> <span class="nav-text">registries.conf</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mounts-conf"><span class="nav-number">4.3.</span> <span class="nav-text">mounts.conf</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#policy-json"><span class="nav-number">4.4.</span> <span class="nav-text">policy.json</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#images使用"><span class="nav-number">5.</span> <span class="nav-text">images使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#搜索镜像"><span class="nav-number">5.1.</span> <span class="nav-text">搜索镜像</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#构建镜像"><span class="nav-number">5.2.</span> <span class="nav-text">构建镜像</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#拉取"><span class="nav-number">5.3.</span> <span class="nav-text">拉取</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#检查和删除"><span class="nav-number">5.4.</span> <span class="nav-text">检查和删除</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#容器"><span class="nav-number">6.</span> <span class="nav-text">容器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#运行-停止和删除"><span class="nav-number">6.1.</span> <span class="nav-text">运行,停止和删除</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#checkpoint-restore"><span class="nav-number">7.</span> <span class="nav-text">checkpoint&#x2F;restore</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#健康检查"><span class="nav-number">8.</span> <span class="nav-text">健康检查</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#systemd"><span class="nav-number">9.</span> <span class="nav-text">systemd</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Pod"><span class="nav-number">10.</span> <span class="nav-text">Pod</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#先创建一个pod"><span class="nav-number">10.1.</span> <span class="nav-text">先创建一个pod</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#k8s联动"><span class="nav-number">11.</span> <span class="nav-text">k8s联动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#总结"><span class="nav-number">12.</span> <span class="nav-text">总结</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="青梅煮马" src="/uploads/avatar.png"><p class="site-author-name" itemprop="name">青梅煮马</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">13</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <span class="site-state-item-count">6</span> <span class="site-state-item-name">分类</span></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">8</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/yangfan16" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yangfan16" rel="noopener" target="_blank"><i class="github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:yangfan9915@gmail.com" title="E-Mail → mailto:yangfan9915@gmail.com" rel="noopener" target="_blank"><i class="envelope fa-fw"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://weibo.com/52012536" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;52012536" rel="noopener" target="_blank"><i class="weibo fa-fw"></i> Weibo</a></span></div><div class="cc-license motion-element" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="link fa-fw"></i> 大佬博客链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="https://think2011.net/" title="https:&#x2F;&#x2F;think2011.net&#x2F;" rel="noopener" target="_blank">曾浩的博客</a></li><li class="links-of-blogroll-item"> <a href="https://ninghao.net/blog" title="https:&#x2F;&#x2F;ninghao.net&#x2F;blog" rel="noopener" target="_blank">王皓的博客</a></li></ul></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">京ICP备17005352号-2</a> <img src="/uploads/beian.png" style="display:inline-block"></div><div class="copyright"> &copy; <span itemprop="copyrightYear">2020</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">青梅煮马</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-chart-area"></i></span> <span class="post-meta-item-text">站点总字数：</span> <span title="站点总字数">88k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span class="post-meta-item-text">站点阅读时长 &asymp;</span> <span title="站点阅读时长">1:20</span></div><div class="addthis_inline_share_toolbox"><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e79f11b160a4070" async="async"></script></div></div></footer></div><script size="200" alpha="0.4" zindex="-1" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-ribbon@1/canvas-ribbon.js"></script><script src="//cdn.jsdelivr.net/npm/animejs@3.1.0/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-pjax@0/pjax.min.js"></script><script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/lozad.js/1.14.0/lozad.min.js"></script><script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script><script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script><script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script><script data-pjax>CONFIG.page.isPost&&(wpac_init=window.wpac_init||[],wpac_init.push({widget:"Rating",id:10254,el:"wpac-rating",color:"fc6423"}),function(){if(!("WIDGETPACK_LOADED"in window)){WIDGETPACK_LOADED=!0;var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//embed.widgetpack.com/widget.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t.nextSibling)}}())</script><div id="pjax"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'f9f42cb27214f7d10b14',
      clientSecret: '147d85755db76790cff0442b7f5123e0032cba08',
      repo        : 'gitalk',
      owner       : 'yangfan16',
      admin       : ['yangfan16'],
      id          : 'b15446cc7baf03d2e349b32ca1893735',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></div></body></html>