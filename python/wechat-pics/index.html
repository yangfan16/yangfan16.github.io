<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/uploads/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/uploads/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/uploads/favicon-16x16.png"><link rel="mask-icon" href="/uploads/safari-pinned-tab.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"blog.yangfan16.cn",root:"/",scheme:"Mist",version:"7.8.0",exturl:!1,sidebar:{position:"right",display:"hide",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!0,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!0,lazyload:!0,pangu:!0,comments:{style:"buttons",active:"gitalk",storage:!0,lazyload:!1,nav:null,activeClass:"gitalk"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!1,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!0,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="最近斗图老输，完全不符合我表情包之王，国家殿堂级斗图高手的身份，一直想着怎么给我的表情包扩充一下新的血液；在B站也刷到半佛仙人的视频，发现他的表情包是多而沙雕，也刷到了桂大佬做的怎么下载,就顺着写了一下。现在的版本暂时只下载一篇文章中的，后续版本下载公众号中全部文章的图片。"><meta property="og:type" content="article"><meta property="og:title" content="Python爬取微信公众号上的图片"><meta property="og:url" content="https://blog.yangfan16.cn/python/wechat-pics/index.html"><meta property="og:site_name" content="青梅梦呓"><meta property="og:description" content="最近斗图老输，完全不符合我表情包之王，国家殿堂级斗图高手的身份，一直想着怎么给我的表情包扩充一下新的血液；在B站也刷到半佛仙人的视频，发现他的表情包是多而沙雕，也刷到了桂大佬做的怎么下载,就顺着写了一下。现在的版本暂时只下载一篇文章中的，后续版本下载公众号中全部文章的图片。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://images.yangfan16.cn/pycharm-interpreter.jpeg"><meta property="article:published_time" content="2020-05-03T02:09:14.000Z"><meta property="article:modified_time" content="2020-05-04T14:35:10.703Z"><meta property="article:author" content="青梅煮马"><meta property="article:tag" content="python"><meta property="article:tag" content="爬虫"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://images.yangfan16.cn/pycharm-interpreter.jpeg"><link rel="canonical" href="https://blog.yangfan16.cn/python/wechat-pics/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>Python爬取微信公众号上的图片 | 青梅梦呓</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">青梅梦呓</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">和世界交手的这许多年，你是否光彩依旧，兴致盎然</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i> 首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i> 归档</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i> 标签</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i> 关于</a></li></ul></nav></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a> <a href="https://github.com/yangfan16" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.yangfan16.cn/python/wechat-pics/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/uploads/avatar.png"><meta itemprop="name" content="青梅煮马"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="青梅梦呓"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Python爬取微信公众号上的图片</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-05-03 10:09:14" itemprop="dateCreated datePublished" datetime="2020-05-03T10:09:14+08:00">2020-05-03</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>10k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span>9 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>最近斗图老输，完全不符合我表情包之王，国家殿堂级斗图高手的身份，一直想着怎么给我的表情包扩充一下新的血液；在B站也刷到半佛仙人的视频，发现他的表情包是多而沙雕，也刷到了桂大佬做的怎么下载,就顺着写了一下。现在的版本暂时只下载一篇文章中的，后续版本下载公众号中全部文章的图片。</p></blockquote><a id="more"></a><p>我的Mac OS系统是10.15.4版本的，使用PyCharm开发，开始写的时候python版本是3.7的，后续升级成为了3.8.2</p><h3 id="安装使用3-8-2版本的python"><a href="#安装使用3-8-2版本的python" class="headerlink" title="安装使用3.8.2版本的python"></a>安装使用3.8.2版本的python</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">brew update &amp;&amp; brew upgrade</span><br><span class="line"># 安装pyenv 我之前没有，已经安装的可以不用</span><br><span class="line">brew install pyenv </span><br><span class="line"># 我使用 oh-my-zsh SHELL</span><br><span class="line">echo &#39;export PATH&#x3D;&quot;$(pyenv root)&#x2F;shims:$PATH&quot;&#39; &gt;&gt; ~&#x2F;.zshrc</span><br><span class="line">source ~&#x2F;.zshrc</span><br><span class="line"># 目前最新的python3.8.2 选择适合的</span><br><span class="line">pyenv install --list | grep 3.8</span><br><span class="line"># 安装3.8.2</span><br><span class="line">pyenv install 3.8.2</span><br><span class="line"># 查看目前的python</span><br><span class="line">pyenv versions</span><br><span class="line">pyenv local 3.8.2</span><br><span class="line"># 设置全局 pyenv --help可以查看</span><br><span class="line">pyenv global 3.8.2</span><br><span class="line"># type查看</span><br><span class="line">type -a python</span><br><span class="line"># 重新打开终端</span><br><span class="line">python -V</span><br><span class="line"># 顺手升级pip</span><br><span class="line">pip install --upgrade pip</span><br></pre></td></tr></table></figure><h3 id="PyCharm-使用pytho3-8-2"><a href="#PyCharm-使用pytho3-8-2" class="headerlink" title="PyCharm 使用pytho3.8.2"></a>PyCharm 使用pytho3.8.2</h3><p>在项目的右下角可以看到PyCharm当前使用的Python解释器版本，默认是跟谁系统的3.7.2(brew install python)。 通过以下操作可以将其更换为3.8.2</p><p>Preferences(Command + ,) -&gt; Project -&gt; Python Interpreter -&gt; 选择Python3.8.2。 如下图所示。<br><img data-src="https://images.yangfan16.cn/pycharm-interpreter.jpeg" alt="PyCharm解释器配置"></p><h3 id="爬取页面图片的url"><a href="#爬取页面图片的url" class="headerlink" title="爬取页面图片的url"></a>爬取页面图片的url</h3><p>搜狗微信可以直接查看微信的连接，直接用搜狗微信公众号的链接即可，使用requests即可查看到， 查看页面的元素就能看到图片连接都在data-src里面，正则匹配一下就可以</p><p>需要安装的库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install requests</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">def get_urls(url):</span><br><span class="line">    try:</span><br><span class="line">        html &#x3D; requests.get(url, timeout&#x3D;30).text</span><br><span class="line">    except requests.exceptions.SSLError:</span><br><span class="line">        html &#x3D; requests.get(url, verify&#x3D;False, timeout&#x3D;30).text</span><br><span class="line">    except TimeoutError:</span><br><span class="line">        print(&#39;请求超时&#39;)</span><br><span class="line">    except Exception:</span><br><span class="line">        print(&#39;获取图片链接失败&#39;)</span><br><span class="line">    src &#x3D; re.compile(r&#39;data-src&#x3D;&quot;(.*?)&quot;&#39;)</span><br><span class="line">    urls &#x3D; re.findall(src, html)</span><br><span class="line">    if urls is not None:</span><br><span class="line">        url_list &#x3D; []</span><br><span class="line">        for url in urls:</span><br><span class="line">            url_list.append(url)</span><br><span class="line">        return url_list</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"># main 函数</span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;</span><br><span class="line">    # 这链接经常会过期，自己去https:&#x2F;&#x2F;weixin.sogou.com&#x2F; 搜索可用的链接</span><br><span class="line">    # 我使用的文章是 《体育考试作弊会毁了你》</span><br><span class="line">    sample &#x3D; &quot;https:&#x2F;&#x2F;mp.weixin.qq.com&#x2F;s?src&#x3D;11&amp;timestamp&#x3D;1588487130&amp;ver&#x3D;2315&amp;signature&#x3D;EbcpQeUVIa3ICzS4H7mTb5mt*o2SrYuEC6Ff0Pr7o7wtVG-OHb-IiSek5Wt6cUFR-X8zwrV5Nri5aoyVLH0ys3kLPOnTfks3ni0RhtPdKHios6B9XTkHhuyOKzNXShF-&amp;new&#x3D;1&quot;</span><br><span class="line">    img_urls &#x3D; get_urls(sample)</span><br><span class="line">    print(img_urls)</span><br></pre></td></tr></table></figure><blockquote><p>一开始不知道为啥我一导入requests包运行程序就会异常退出，纠结了半天才找到问题<br>因为我的mac的/usr/local/lib 里面没有libssl.dylib 和 libcrypto.dylib这两个文件<br>有可能旧版本的openssl 也会有如下问题，旧版本的openssl也可能会有问题。 如下操作即可。</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;usr&#x2F;local&#x2F;Cellar&#x2F;openssl@1.1&#x2F;1.1.1g&#x2F;lib</span><br><span class="line">sudo cp libssl.1.1.dylib libcrypto.1.1.dylib &#x2F;usr&#x2F;local&#x2F;lib&#x2F;</span><br><span class="line">cd &#x2F;usr&#x2F;local&#x2F;lib</span><br><span class="line"># 如果有旧的最好备份一下 mv</span><br><span class="line">mv libssl.dylib libssl_bak.dylib</span><br><span class="line">mv libcrypto.dylib libcrypto_bak.dylib</span><br><span class="line"># 建立软链</span><br><span class="line">sudo ln -s libssl.1.1.dylib libssl.dylib</span><br><span class="line">sudo ln -s libcrypto.1.1.dylib libcrypto.dylib</span><br></pre></td></tr></table></figure><p>运行一下就能看到我们已经把这个文章中的图片连接已经全部得到了。</p><h3 id="下载图片"><a href="#下载图片" class="headerlink" title="下载图片"></a>下载图片</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"># 创建保存图片的文件夹</span><br><span class="line">def mkdir(base_path):</span><br><span class="line">    isExists &#x3D; os.path.exists(base_path)</span><br><span class="line">    if not isExists:</span><br><span class="line">        print(&#39;创建目录&#39;)</span><br><span class="line">        os.makedirs(base_path)  # 创建目录</span><br><span class="line">        os.chdir(base_path)  # 切换到创建的文件夹</span><br><span class="line">        return True</span><br><span class="line">    else:</span><br><span class="line">        print(&#39;目录已存在，即将保存！&#39;)</span><br><span class="line">        return False</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"># 下载图片并写入到指定的文件夹中</span><br><span class="line">def download(base_path, image_urls):</span><br><span class="line">    for url in image_urls:</span><br><span class="line">        filename &#x3D; base_path + url.split(&#39;&#x2F;&#39;)[-2] + &#39;.&#39; + url.split(&#39;&#x3D;&#39;)[-1]</span><br><span class="line">        try:</span><br><span class="line">            with open(filename, &#39;wb+&#39;) as f:</span><br><span class="line">                try:</span><br><span class="line">                    f.write(requests.get(url, timeout&#x3D;30).content)</span><br><span class="line">                    print(&#39;成功下载图片：&#39;, filename)</span><br><span class="line">                except requests.exceptions.SSLError:</span><br><span class="line">                    f.write(requests.get(url, verify&#x3D;False, timeout&#x3D;30).content)</span><br><span class="line">                    print(&#39;成功下载图片：&#39;, filename)</span><br><span class="line">        except FileNotFoundError:</span><br><span class="line">            print(&#39;下载失败！！没有找到对应图片目前，请检查路径：&#39;, filename)</span><br><span class="line">            pass</span><br><span class="line">        except TimeoutError:</span><br><span class="line">            print(&#39;下载超时：&#39;, filename)</span><br><span class="line">            pass</span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(&#39;非正常图片，直接忽略：&#39;, filename, e)</span><br><span class="line">            pass</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># main函数</span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    sample &#x3D; &quot;https:&#x2F;&#x2F;mp.weixin.qq.com&#x2F;s?src&#x3D;11&amp;timestamp&#x3D;1588487130&amp;ver&#x3D;2315&amp;signature&#x3D;EbcpQeUVIa3ICzS4H7mTb5mt*o2SrYuEC6Ff0Pr7o7wtVG-OHb-IiSek5Wt6cUFR-X8zwrV5Nri5aoyVLH0ys3kLPOnTfks3ni0RhtPdKHios6B9XTkHhuyOKzNXShF-&amp;new&#x3D;1&quot;</span><br><span class="line">    img_urls &#x3D; get_urls(sample)</span><br><span class="line">    base_path &#x3D; r&#39;.&#x2F;weichat_pics&#x2F;&#39;</span><br><span class="line">    try:</span><br><span class="line">        mkdir(base_path)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(&quot;建立文件异常&quot;, e)</span><br><span class="line">    print(&quot;保存图片文件夹正常&quot;)</span><br><span class="line">    download(base_path, img_urls)</span><br></pre></td></tr></table></figure><p>再次运行代码就能看到，已经将这篇文章中所有的图片均已经下载到指定的文件夹中。</p><h3 id="使用百度的OCR重命名文件"><a href="#使用百度的OCR重命名文件" class="headerlink" title="使用百度的OCR重命名文件"></a>使用百度的OCR重命名文件</h3><h4 id="创建百度文字识别应用"><a href="#创建百度文字识别应用" class="headerlink" title="创建百度文字识别应用"></a>创建百度文字识别应用</h4><p>百度账号应该都有，<a href="https://ai.baidu.com/" target="_blank" rel="noopener">直接到百度AI只能开放平台</a>，登录后直接进入到控制台，<a href="https://console.bce.baidu.com/ai/?fromai=1#/ai/ocr/overview/index" target="_blank" rel="noopener">点击文字识别</a>。创建应用即可。可以在下面看到调用次数和API类型，可惜就是给的免费QPS低了点。有了应用之后直接使用百度提供的SDK python-aip。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install baidu-aip</span><br></pre></td></tr></table></figure><h4 id="使用OCR识别图片中的文字"><a href="#使用OCR识别图片中的文字" class="headerlink" title="使用OCR识别图片中的文字"></a>使用OCR识别图片中的文字</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">def baiduOCR(picfile):</span><br><span class="line">    &quot;&quot;&quot;利用百度api识别文本，并保存提取的文字</span><br><span class="line">    把下面的ID KEY 和SK替换成自己的就可以了</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    APP_ID &#x3D; &#39;xxxxxx&#39;</span><br><span class="line">    API_KEY &#x3D; &#39;xxxxxx&#39;</span><br><span class="line">    SECRECT_KEY &#x3D; &#39;xxxxxxxx&#39;</span><br><span class="line">    client &#x3D; AipOcr(APP_ID, API_KEY, SECRECT_KEY)</span><br><span class="line">    i &#x3D; open(picfile, &#39;rb&#39;)</span><br><span class="line">    img &#x3D; i.read()</span><br><span class="line">    try:</span><br><span class="line">        message &#x3D; client.basicGeneral(img)[&#39;words_result&#39;]  # 通用文字识别</span><br><span class="line">        value &#x3D; []</span><br><span class="line">        for j in message:</span><br><span class="line">            value.append(j[&#39;words&#39;])</span><br><span class="line">        t &#x3D; &#39;&#39;.join(value)</span><br><span class="line">        title &#x3D; t.replace(&#39;&#x2F;&#39;, &#39;&#39;).replace(&#39;\\&#39;, &#39;&#39;).replace(&#39;:&#39;, &#39;&#39;).replace(&#39;*&#39;, &#39;&#39;).replace(&#39;?&#39;, &#39;&#39;).replace(&#39;&lt;&#39;, &#39;&#39;) \</span><br><span class="line">            .replace(&#39;&gt;&#39;, &#39;&#39;).replace(&#39;|&#39;, &#39;&#39;).replace(&#39;.&#39;, &#39;&#39;)</span><br><span class="line">        # .strip(&#39;&#x2F;&#39;).strip(&#39;\\&#39;).strip(&#39;:&#39;).strip(&#39;*&#39;).strip(&#39;?&#39;).strip(&#39;&lt;&#39;).strip(&#39;&gt;&#39;).strip(&#39;|&#39;).strip(&#39;.&#39;)</span><br><span class="line">        timestamp &#x3D; int(time.time())</span><br><span class="line">        if title &#x3D;&#x3D; &quot;&quot; or title &#x3D;&#x3D; None:</span><br><span class="line">            title &#x3D; timestamp</span><br><span class="line">            return title</span><br><span class="line">        i.close()</span><br><span class="line">        return title</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(e)</span><br><span class="line">        print(&#39;此图片类型无法识别&#39;)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"># 修改下download函数，在下载完一张图片后就试着重命名下</span><br><span class="line">def download(base_path, image_urls):</span><br><span class="line">    for url in image_urls:</span><br><span class="line">        filename &#x3D; base_path + url.split(&#39;&#x2F;&#39;)[-2] + &#39;.&#39; + url.split(&#39;&#x3D;&#39;)[-1]</span><br><span class="line">        try:</span><br><span class="line">            with open(filename, &#39;wb+&#39;) as f:</span><br><span class="line">                try:</span><br><span class="line">                    f.write(requests.get(url, timeout&#x3D;30).content)</span><br><span class="line">                    print(&#39;成功下载图片：&#39;, filename)</span><br><span class="line">                except requests.exceptions.SSLError:</span><br><span class="line">                    f.write(requests.get(url, verify&#x3D;False, timeout&#x3D;30).content)</span><br><span class="line">                    print(&#39;成功下载图片：&#39;, filename)</span><br><span class="line">        except FileNotFoundError:</span><br><span class="line">            print(&#39;下载失败！！没有找到对应图片目前，请检查路径：&#39;, filename)</span><br><span class="line">            pass</span><br><span class="line">        except TimeoutError:</span><br><span class="line">            print(&#39;下载超时：&#39;, filename)</span><br><span class="line">            pass</span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(&#39;非正常图片，直接忽略：&#39;, filename, e)</span><br><span class="line">            pass</span><br><span class="line">        try:</span><br><span class="line">            title &#x3D; baiduOCR(filename)</span><br><span class="line">            timestamp &#x3D; int(time.time())</span><br><span class="line">            pic_type &#x3D; url.split(&#39;&#x3D;&#39;)[-1]</span><br><span class="line">            if pic_type &#x3D;&#x3D; &#39;gif&#39;:</span><br><span class="line">                new_name &#x3D; base_path + str(timestamp) + &#39;.&#39; + pic_type</span><br><span class="line">            else:</span><br><span class="line">                new_name &#x3D; base_path + str(title) + &#39;.&#39; + pic_type</span><br><span class="line">                os.rename(filename, new_name)</span><br><span class="line">            print(&#39;文件重命名成功% s&#39; % (new_name))</span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(&#39;重命名失败！忽略&#39;, e)</span><br></pre></td></tr></table></figure><blockquote><p>Ps: pip instll aip 和pip install baidu-aip下载是两个包，前者需要暂时卸载了</p></blockquote><p>再次运行程序，基本就能看到已经有些字迹清晰完整的图片已经成功重新命名。</p><h4 id="完整程序代码"><a href="#完整程序代码" class="headerlink" title="完整程序代码"></a>完整程序代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"></span><br><span class="line">import os</span><br><span class="line">import re</span><br><span class="line">import time</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">from aip import AipOcr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def baiduOCR(picfile):</span><br><span class="line">    &quot;&quot;&quot;利用百度api识别文本，并保存提取的文字</span><br><span class="line">    把下面的ID KEY 和SK替换成自己的就可以了</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    APP_ID &#x3D; &#39;xxxxxxxxx&#39;</span><br><span class="line">    API_KEY &#x3D; &#39;xxxxxxxxx&#39;</span><br><span class="line">    SECRECT_KEY &#x3D; &#39;xxxxxxxxx&#39;</span><br><span class="line">    client &#x3D; AipOcr(APP_ID, API_KEY, SECRECT_KEY)</span><br><span class="line">    i &#x3D; open(picfile, &#39;rb&#39;)</span><br><span class="line">    img &#x3D; i.read()</span><br><span class="line">    try:</span><br><span class="line">        message &#x3D; client.basicGeneral(img)[&#39;words_result&#39;]  # 通用文字识别</span><br><span class="line">        value &#x3D; []</span><br><span class="line">        for j in message:</span><br><span class="line">            value.append(j[&#39;words&#39;])</span><br><span class="line">        t &#x3D; &#39;&#39;.join(value)</span><br><span class="line">        title &#x3D; t.replace(&#39;&#x2F;&#39;, &#39;&#39;).replace(&#39;\\&#39;, &#39;&#39;).replace(&#39;:&#39;, &#39;&#39;).replace(&#39;*&#39;, &#39;&#39;).replace(&#39;?&#39;, &#39;&#39;).replace(&#39;&lt;&#39;, &#39;&#39;) \</span><br><span class="line">            .replace(&#39;&gt;&#39;, &#39;&#39;).replace(&#39;|&#39;, &#39;&#39;).replace(&#39;.&#39;, &#39;&#39;)</span><br><span class="line">        # .strip(&#39;&#x2F;&#39;).strip(&#39;\\&#39;).strip(&#39;:&#39;).strip(&#39;*&#39;).strip(&#39;?&#39;).strip(&#39;&lt;&#39;).strip(&#39;&gt;&#39;).strip(&#39;|&#39;).strip(&#39;.&#39;)</span><br><span class="line">        timestamp &#x3D; int(time.time())</span><br><span class="line">        if title &#x3D;&#x3D; &quot;&quot; or title &#x3D;&#x3D; None:</span><br><span class="line">            title &#x3D; timestamp</span><br><span class="line">            return title</span><br><span class="line">        i.close()</span><br><span class="line">        return title</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(e)</span><br><span class="line">        print(&#39;此图片类型无法识别&#39;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_urls(url):</span><br><span class="line">    try:</span><br><span class="line">        html &#x3D; requests.get(url, timeout&#x3D;30).text</span><br><span class="line">    except requests.exceptions.SSLError:</span><br><span class="line">        html &#x3D; requests.get(url, verify&#x3D;False, timeout&#x3D;30).text</span><br><span class="line">    except TimeoutError:</span><br><span class="line">        print(&#39;请求超时&#39;)</span><br><span class="line">    except Exception:</span><br><span class="line">        print(&#39;获取图片链接失败&#39;)</span><br><span class="line">    src &#x3D; re.compile(r&#39;data-src&#x3D;&quot;(.*?)&quot;&#39;)</span><br><span class="line">    urls &#x3D; re.findall(src, html)</span><br><span class="line">    if urls is not None:</span><br><span class="line">        url_list &#x3D; []</span><br><span class="line">        for url in urls:</span><br><span class="line">            url_list.append(url)</span><br><span class="line">        return url_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def mkdir(base_path):</span><br><span class="line">    isExists &#x3D; os.path.exists(base_path)</span><br><span class="line">    if not isExists:</span><br><span class="line">        print(&#39;创建目录&#39;)</span><br><span class="line">        os.makedirs(base_path)  # 创建目录</span><br><span class="line">        os.chdir(base_path)  # 切换到创建的文件夹</span><br><span class="line">        return True</span><br><span class="line">    else:</span><br><span class="line">        print(&#39;目录已存在，即将保存！&#39;)</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def download(base_path, image_urls):</span><br><span class="line">    for url in image_urls:</span><br><span class="line">        filename &#x3D; base_path + url.split(&#39;&#x2F;&#39;)[-2] + &#39;.&#39; + url.split(&#39;&#x3D;&#39;)[-1]</span><br><span class="line">        try:</span><br><span class="line">            with open(filename, &#39;wb+&#39;) as f:</span><br><span class="line">                try:</span><br><span class="line">                    f.write(requests.get(url, timeout&#x3D;30).content)</span><br><span class="line">                    print(&#39;成功下载图片：&#39;, filename)</span><br><span class="line">                except requests.exceptions.SSLError:</span><br><span class="line">                    f.write(requests.get(url, verify&#x3D;False, timeout&#x3D;30).content)</span><br><span class="line">                    print(&#39;成功下载图片：&#39;, filename)</span><br><span class="line">        except FileNotFoundError:</span><br><span class="line">            print(&#39;下载失败！！没有找到对应图片目前，请检查路径：&#39;, filename)</span><br><span class="line">            pass</span><br><span class="line">        except TimeoutError:</span><br><span class="line">            print(&#39;下载超时：&#39;, filename)</span><br><span class="line">            pass</span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(&#39;非正常图片，直接忽略：&#39;, filename, e)</span><br><span class="line">            pass</span><br><span class="line">        try:</span><br><span class="line">            title &#x3D; baiduOCR(filename)</span><br><span class="line">            timestamp &#x3D; int(time.time())</span><br><span class="line">            pic_type &#x3D; url.split(&#39;&#x3D;&#39;)[-1]</span><br><span class="line">            if pic_type &#x3D;&#x3D; &#39;gif&#39;:</span><br><span class="line">                new_name &#x3D; base_path + str(timestamp) + &#39;.&#39; + pic_type</span><br><span class="line">            else:</span><br><span class="line">                new_name &#x3D; base_path + str(title) + &#39;.&#39; + pic_type</span><br><span class="line">                os.rename(filename, new_name)</span><br><span class="line">            print(&#39;文件重命名成功% s&#39; % (new_name))</span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(&#39;重命名失败！忽略&#39;, e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    sample &#x3D; &quot;https:&#x2F;&#x2F;mp.weixin.qq.com&#x2F;s?src&#x3D;11&amp;timestamp&#x3D;1588487130&amp;ver&#x3D;2315&amp;signature&#x3D;EbcpQeUVIa3ICzS4H7mTb5mt*o2SrYuEC6Ff0Pr7o7wtVG-OHb-IiSek5Wt6cUFR-X8zwrV5Nri5aoyVLH0ys3kLPOnTfks3ni0RhtPdKHios6B9XTkHhuyOKzNXShF-&amp;new&#x3D;1&quot;</span><br><span class="line">    img_urls &#x3D; get_urls(sample)</span><br><span class="line">    base_path &#x3D; r&#39;.&#x2F;weichat_pics&#x2F;&#39;</span><br><span class="line">    try:</span><br><span class="line">        mkdir(base_path)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(&quot;建立文件异常&quot;, e)</span><br><span class="line">    print(&quot;保存图片文件夹正常&quot;)</span><br><span class="line">    download(base_path, img_urls)</span><br></pre></td></tr></table></figure></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 青梅煮马</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://blog.yangfan16.cn/python/wechat-pics/" title="Python爬取微信公众号上的图片">https://blog.yangfan16.cn/python/wechat-pics/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/python/" rel="tag"><i class="fa fa-tag"></i> python</a></div><div class="post-widgets"><div class="wp_rating"><div id="wpac-rating"></div></div></div><div class="post-nav"><div class="post-nav-item"><a href="/others/podman-experience/" rel="prev" title="Podman 初体验"><i class="fa fa-chevron-left"></i> Podman 初体验</a></div><div class="post-nav-item"> <a href="/others/brew-remote/" rel="next" title="更换和重置Mac Homebrew的默认源">更换和重置Mac Homebrew的默认源<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装使用3-8-2版本的python"><span class="nav-number">1.</span> <span class="nav-text">安装使用3.8.2版本的python</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PyCharm-使用pytho3-8-2"><span class="nav-number">2.</span> <span class="nav-text">PyCharm 使用pytho3.8.2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#爬取页面图片的url"><span class="nav-number">3.</span> <span class="nav-text">爬取页面图片的url</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#下载图片"><span class="nav-number">4.</span> <span class="nav-text">下载图片</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用百度的OCR重命名文件"><span class="nav-number">5.</span> <span class="nav-text">使用百度的OCR重命名文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#创建百度文字识别应用"><span class="nav-number">5.1.</span> <span class="nav-text">创建百度文字识别应用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用OCR识别图片中的文字"><span class="nav-number">5.2.</span> <span class="nav-text">使用OCR识别图片中的文字</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#完整程序代码"><span class="nav-number">5.3.</span> <span class="nav-text">完整程序代码</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="青梅煮马" src="/uploads/avatar.png"><p class="site-author-name" itemprop="name">青梅煮马</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">7</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <span class="site-state-item-count">4</span> <span class="site-state-item-name">分类</span></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">5</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/yangfan16" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yangfan16" rel="noopener" target="_blank"><i class="github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:yangfan9915@gmail.com" title="E-Mail → mailto:yangfan9915@gmail.com" rel="noopener" target="_blank"><i class="envelope fa-fw"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://weibo.com/52012536" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;52012536" rel="noopener" target="_blank"><i class="weibo fa-fw"></i> Weibo</a></span></div><div class="cc-license motion-element" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="link fa-fw"></i> 大佬博客链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="https://think2011.net/" title="https:&#x2F;&#x2F;think2011.net&#x2F;" rel="noopener" target="_blank">曾浩的博客</a></li><li class="links-of-blogroll-item"> <a href="https://ninghao.net/blog" title="https:&#x2F;&#x2F;ninghao.net&#x2F;blog" rel="noopener" target="_blank">王皓的博客</a></li></ul></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">京ICP备17005352号-2</a> <img src="/uploads/beian.png" style="display:inline-block"></div><div class="copyright"> &copy; <span itemprop="copyrightYear">2020</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">青梅煮马</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-chart-area"></i></span> <span class="post-meta-item-text">站点总字数：</span> <span title="站点总字数">38k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span class="post-meta-item-text">站点阅读时长 &asymp;</span> <span title="站点阅读时长">34 分钟</span></div><div class="addthis_inline_share_toolbox"><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e79f11b160a4070" async="async"></script></div></div></footer></div><script size="200" alpha="0.4" zindex="-1" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-ribbon@1/canvas-ribbon.js"></script><script src="//cdn.jsdelivr.net/npm/animejs@3.1.0/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-pjax@0/pjax.min.js"></script><script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/lozad.js/1.14.0/lozad.min.js"></script><script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script><script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script><script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script><script data-pjax>CONFIG.page.isPost&&(wpac_init=window.wpac_init||[],wpac_init.push({widget:"Rating",id:10254,el:"wpac-rating",color:"fc6423"}),function(){if(!("WIDGETPACK_LOADED"in window)){WIDGETPACK_LOADED=!0;var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//embed.widgetpack.com/widget.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t.nextSibling)}}())</script><div id="pjax"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'f9f42cb27214f7d10b14',
      clientSecret: '147d85755db76790cff0442b7f5123e0032cba08',
      repo        : 'gitalk',
      owner       : 'yangfan16',
      admin       : ['yangfan16'],
      id          : 'b1bd70d615dfae7c5ad2bd329944ae6b',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></div></body></html>